
.ad l

.TH brsvadd 8 "July 2021" "" ""
.ll 72

.ce 1000
\fBbrsvadd\fR
.ce 0

.sp 2
Adds an advance reservation.
.sp 2

.SH Synopsis

.sp 2
\fBbrsvadd\fR [\fB-o\fR] [\fB-f\fR] [\fB-d
"\fRdescription\fB"\fR] [\fB-N\fR reservation_name]
[\fB-nosusp\fR] [\fB-q "\fRqueue_name ...\fB"\fR] [\fB-E\fR
pre_ar_script] [\fB-Et\fR pre_ar_time] [\fB-Ep\fR post_ar_script
[\fB-Ept\fR post_ar_time]]
.sp 2
{\fB-u\fR \fB"\fRuser_name ...\fB"\fR | \fB-u \fR"user_group
 ...\fB"\fR}
.sp 2
{[\fB-unit slot\fR] \fB-n\fR job_slots | \fB-unit host\fR
\fB-n\fR number_hosts}
.sp 2
{\fB-m \fR \fB"\fRhost_name … \fB"\fR | \fB"\fRhost_group
 ...\fB"\fR [\fB-R\fR \fB"\fRres_req\fB"\fR] |
.sp 2
[\fB-m\fR \fB"\fRhost_name … | \fB"\fR host_group ...\fB"\fR]
\fB-R \fR \fB"\fRres_req\fB"\fR}
.sp 2
{\fB-b\fR begin_time \fB-e\fR end_time | \fB-t\fR time_window}
.sp 2
\fBbrsvadd\fR [\fB-f\fR] [\fB-d\fR \fB"\fRdescription\fB"\fR]
[\fB-N\fR reservation_name] [\fB-q "\fRqueue_name ...\fB"\fR]
[\fB-E\fR pre_ar_script] [\fB-Et\fR pre_ar_time] [\fB-Ep\fR
post_ar_script [\fB-Ept\fR post_ar_time]]
.sp 2
\fB-s\fR | {\fB-m\fR \fB"\fRhost_name ... | host_group ...\fB"\fR
[\fB-R\fR \fB"\fRres_req\fB"\fR] |
.sp 2
[\fB-m\fR \fB"\fRhost_name ...\fB"\fR | \fB-m \fR
\fB"\fRhost_group ...\fB"\fR] \fB-R\fR \fB"\fRres_req\fB"\fR}
.sp 2
{\fB-b\fR begin_time \fB-e\fR end_time | \fB-t\fR time_window}
.sp 2
\fBbrsvadd\fR [\fB-o\fR] [\fB-f\fR] \fB-p\fR [\fB-d\fR
\fB"\fRdescription\fB"\fR] [\fB-N\fR reservation_name]
.sp 2
{\fB-u\fR \fB"\fRuser_name ...\fB"\fR | \fB-u \fR"user_group
 ...\fB"\fR}
.sp 2
[\fB-unit slot\fR | \fB-unit host\fR]
.sp 2
\fBbrsvadd\fR {\fB-h\fR | \fB-V\fR}
.SH Description

.sp 2
\fBCAUTION: \fR
.sp 2
By default, this command can be used only by LSF administrators
or root.
.sp 2
Reserves job slots or hosts in advance for a specified period for
a user or user group, or for system maintenance purposes. Use the
-b and -e options for one-time reservations, and the -t option
for recurring reservations.
.sp 2
To allow users to create their own advance reservations without
administrator intervention, configure advance reservation
policies in the \fRResourceReservation\fR section of the
lsb.resources file.
.sp 2
Only administrators, root, or the users who are listed in the
\fRResourceReservation\fR section can add reservations for
themselves or any other user or user group.
.sp 2
Advance reservations must be 10 minutes or more in length.
.sp 2
\fBNote: \fR
.sp 2
Advance reservations might be rejected if they overlap other
advance reservations that begin or end within a 10-minute time
period.
.sp 2
A day is divided into 144 periods. Each period lasts for 10
minutes. For example, \fR0:0-0:10\fR, \fR0:10-0:20\fR, up to
\fR23:50-24:00\fR. If the start time or end time of a reservation
is in the middle of a time period, LSF reserves the entire
period. For example, if one reservation begins at 1:22 and ends
at 4:24, a reservation request that starts at 4:25 is rejected
because it is within the already reserved 4:20-4:30 time period.
.SH Options

.sp 2
\fB-nosusp\fR
.br
         If specified, LSF will not suspend non-advance
         reservation jobs that are running on the advance
         reservation hosts when the first advance reservation job
         starts. Non-advance reservation jobs continue to run,
         and advance reservation jobs do not start until
         resources are available. This ensures that resources are
         not over-committed.
.sp 2
         This flag is only valid with user advance reservations.
.sp 2
\fB-o\fR
.br
         Creates an open advance reservation. A job with an open
         advance reservation has the advance reservation property
         only during the reservation window. After the
         reservation window closes, the job becomes a normal job,
         not subject to termination.
.sp 2
         An open reservation prevents jobs from being killed if
         the reservation window is too small. Instead, the job is
         suspended and normal scheduling policies apply after the
         reservation window.
.sp 2
\fB-p\fR
.br
         Manually creates an advance reservation placeholder
         without a time window or hosts for use by a dynamically
         scheduled advance reservation. You must use the –u to
         define a user name or user group that uses the
         reservation. The brsvsub command automatically creates a
         placeholder and submits a job to the reservation.
.sp 2
\fB-s\fR
.br
         Creates a reservation for system use. LSF does not
         dispatch jobs to the specified hosts while the
         reservation is active.
.sp 2
         When you specify a system reservation with the -s
         option, you do not need to specify the number of job
         slots to reserve with the -n option.
.sp 2
\fB-b \fIbegin_time\fB\fR
.br
         Begin time for a one-time reservation. The begin time
         has the following form:
.sp 2
         [[[year:]month:]day:]hour:minute
.br

.sp 2
         The begin time has the following ranges:
.sp 2
         \fB\fIyear\fB\fR
.br
                  Any year after 1900 (\fR\fIYYYY\fR\fR).
.sp 2
         \fB\fImonth\fB\fR
.br
                  1-12 (\fR\fIMM\fR\fR).
.sp 2
         \fB\fIday of the month\fB\fR
.br
                  1-31 (\fR\fIdd\fR\fR).
.sp 2
         \fB\fIhour\fB\fR
.br
                  0-23 (\fR\fIhh\fR\fR).
.sp 2
         \fB\fIminute\fB\fR
.br
                  0-59 (\fR\fImm\fR\fR).
.sp 2
         You must specify at least \fR\fIhour\fR:\fIminute\fR\fR.
         Year, month, and day are optional. Three fields are
         assumed to be \fR\fIday\fR:\fIhour\fR:\fIminute\fR\fR.
         Four fields are assumed to be
         \fR\fImonth\fR:\fIday\fR:\fIhour\fR:\fIminute\fR\fR, and
         five fields are
         \fR\fIyear\fR:\fImonth\fR:\fIday\fR:\fIhour\fR:\fIminute\fR\fR.
.sp 2
         If you do not specify a day, LSF assumes the current
         day. If you do not specify a month, LSF assumes the
         current month. If you specify a year, you must specify a
         month.
.sp 2
         The time value for the -b option must use the same
         syntax as the time value for the -e option. It must be
         earlier than the time value for the -e option, and it
         cannot be earlier than the current time.
.sp 2
\fB-d "\fIdescription\fB"\fR
.br
         Specifies a description for the reservation to be
         created. The description must be provided as a double
         quoted text string. The maximum length is 512
         characters.
.sp 2
\fB-E \fIpre_ar_script\fB\fR
.br
         Specifies the absolute file path to a script that is run
         to create the advance reservation. If the creator is not
         root or an LSF administrator, the creator\(aqs user group
         must be an an LSF or queue administrator so that this
         pre-script can take action on other users\(aq jobs.
         \fRLSB_START_EBROKERD=Y\fR must be specified in the
         lsf.conf file for LSF to run the script.
.sp 2
         \fBNote: \fRThe file path can contain up to 4094
         characters for UNIX and Linux, or up to 255 characters
         for Windows, including the directory and file name.
.sp 2
         The following environment variables are available for
         use in the script:
.sp 2
         \fBAR_NAME\fR
.br
                  Name of the advance reservation.
.sp 2
         \fBAR_QUEUE_LIST\fR
.br
                  List of queues whose jobs can be run in this
                  advance reservation.
.sp 2
         \fBAR_HOST_LIST\fR
.br
                  List of hosts in this advance reservation. The
                  host is reported even if the advance
                  reservation does not use all slots on the host.
.sp 2
         \fBAR_START_TIME\fR
.br
                  Start time of this advance reservation in epoch
                  seconds.
.sp 2
         \fBAR_END_TIME\fR
.br
                  End time of this advance reservation in epoch
                  seconds.
.sp 2
         \fBAR_JOBIDS\fR
.br
                  The job IDs of jobs that are currently running
                  on this advance reservation\(aqs hosts.
.sp 2
         \fBAR_CREATOR\fR
.br
                  Name of the user that created this advance
                  reservation.
.sp 2
         \fBAR_OWNERS\fR
.br
                  Name of the owners of this advance reservation.
.sp 2
         The script is run at the start time of the advance
         reservation unless a pre-time is set with the -Et
         option, then the script is run at the start time minus
         the specified pre-time. If the script is modified before
         the script is to be run, the latest version of the
         script is run at the start time of the script.
.sp 2
         The script can use the bpost command to notify the job
         owner that the job was killed by the script. The script
         can also create its own logs and send notifications to
         the creator and owner of the advance reservation. LSF
         does not take any specific action based on the success
         or failure of the script, and there is no timeout period
         or action that is associated with this script.
.sp 2
         If the conditions of the advance reservation or the job
         change while the script is running (for example, with
         the brsvmod or bmod command), the scripts are not
         notified and the environment variables do not change. It
         is the responsibility of the script to handle these
         changes. In addition, after the script is run, any kill
         or requeue actions on the jobs cannot be undone if the
         advance reservation or the job itself is changed with
         the brsvmod or bmod command.
.sp 2
\fB-Ep \fIpost_ar_script\fB\fR
.br
         Specifies the absolute file path to a script that is run
         as the creator of the advance reservation when it
         expires. If the creator is not root or an LSF
         administrator, the creator\(aqs user group should be an an
         LSF or queue administrator so that this post-script can
         take action on other users\(aq jobs.
         \fRLSB_START_EBROKERD=Y\fR must be specified in the
         lsf.conf file for LSF to run the script.
.sp 2
         \fBNote: \fRThe file path can contain up to 4094
         characters for UNIX and Linux, or up to 255 characters
         for Windows, including the directory and file name.
.sp 2
         The following environment variables are available for
         use in the script:
.sp 2
         \fBAR_NAME\fR
.br
                  Name of the advance reservation.
.sp 2
         \fBAR_QUEUE_LIST\fR
.br
                  List of queues whose jobs can be run in this
                  advance reservation.
.sp 2
         \fBAR_HOST_LIST\fR
.br
                  List of hosts in this advance reservation. The
                  host is reported even if the advance
                  reservation does not use all slots on the host.
.sp 2
         \fBAR_START_TIME\fR
.br
                  Start time of this advance reservation as a UTC
                  time stamp.
.sp 2
         \fBAR_END_TIME\fR
.br
                  End time of this advance reservation as a UTC
                  time stamp.
.sp 2
         \fBAR_JOBIDS\fR
.br
                  The job IDs of jobs that are currently running
                  on this advance reservation\(aqs hosts.
.sp 2
         \fBAR_CREATOR\fR
.br
                  Name of the user that created this advance
                  reservation.
.sp 2
         \fBAR_OWNERS\fR
.br
                  Name of the owners of this advance reservation.
.sp 2
         The script is run at the expiry time of the advance
         reservation unless a pre-time is set with the -Ept
         option, then the script is run at the expiry time minus
         the specified pre-time. If the script is modified before
         the script is to be run, the latest version of the
         script is run at the start time of the script.
.sp 2
         The script can use the bpost command to notify the job
         owner that the job was killed by the script. The script
         can also create its own logs and send notifications to
         the creator and owner of the advance reservation. LSF
         does not take any specific action based on the success
         or failure of the script, and there is no timeout period
         or action that is associated with this script.
.sp 2
         If the conditions of the advance reservation or the job
         change while the script is running (for example, with
         the brsvmod or bmod command), the scripts are not
         notified and the environment variables do not change. It
         is the responsibility of the script to handle these
         changes. In addition, after the script is run, any kill
         or requeue actions on the jobs cannot be undone if the
         advance reservation or the job itself is changed with
         the brsvmod or bmod command.
.sp 2
\fB-Ept \fIpost_ar_time\fB\fR
.br
         The amount of time, in minutes, before the expiry of the
         advance reservation for LSF to run the post-script (as
         specified by the -Ep option). This option is ignored if
         it is specified without the -Ep option.
.sp 2
\fB-Et \fIpre_ar_time\fB\fR
.br
         The amount of time, in minutes, before the start of the
         advance reservation for LSF to run the pre-script (as
         specified by the -E option) and to stop dispatching new
         jobs to the advance reservation hosts.
.sp 2
         If this option is specified without the -E option, LSF
         stops dispatching jobs to this advance reservation\(aqs
         hosts at pre-time without running a pre-script.
.sp 2
\fB-e \fIend_time\fB\fR
.br
         End time for a one-time reservation. The end time has
         the following form:
.sp 2
         [[[year:]month:]day:]hour:minute
.br

.sp 2
         The end time has the following ranges:
.sp 2
         \fB\fIyear\fB\fR
.br
                  Any year after 1900 (\fR\fIYYYY\fR\fR).
.sp 2
         \fB\fImonth\fB\fR
.br
                  1-12 (\fR\fIMM\fR\fR).
.sp 2
         \fB\fIday of the month\fB\fR
.br
                  1-31 (\fR\fIdd\fR\fR).
.sp 2
         \fB\fIhour\fB\fR
.br
                  0-23 (\fR\fIhh\fR\fR).
.sp 2
         \fB\fIminute\fB\fR
.br
                  0-59 (\fR\fImm\fR\fR).
.sp 2
         You must specify at least \fR\fIhour\fR:\fIminute\fR\fR.
         Year, month, and day are optional. Three fields are
         assumed to be \fR\fIday\fR:\fIhour\fR:\fIminute\fR\fR.
         Four fields are assumed to be
         \fR\fImonth\fR:\fIday\fR:\fIhour\fR:\fIminute\fR\fR, and
         five fields are
         \fR\fIyear\fR:\fImonth\fR:\fIday\fR:\fIhour\fR:\fIminute\fR\fR.
.sp 2
         If you do not specify a day, LSF assumes the current
         day. If you do not specify a month, LSF assumes the
         current month. If you specify a year, you must specify a
         month.
.sp 2
         The time value for the -e option must use the same
         syntax as the time value for the -b option. It must be
         later than the time value for the -b option.
.sp 2
\fB-f\fR
.br
         Selects hosts based on the specified resource
         requirements (-R/-m option).
.sp 2
         \fBNote: \fRIf \fIAR_AVAILABLE_STATUS\fR in lsb.params
         is defined, then hosts with that status are preferred in
         the AR creation.
.sp 2

.sp 2
\fB-m "\fIhost_name ...\fB | \fIhost_group\fB ..."\fR
.br
         Lists the hosts and groups of hosts that are used for
         the advance reservation request. At job submission, LSF
         considers the hosts in the specified order.
.sp 2
         If you also specify a resource requirement string with
         the -R option, the -m option is not required.
.sp 2
         The hosts can be local to the cluster or hosts that are
         leased from remote clusters.
.sp 2
         The number of slots that are specified by the \fR-n
         \fI<job_slots>\fR\fR option or hosts that are specified
         by \fR-n \fI<number_hosts>\fR\fR option must be less
         than or equal to the actual number of hosts that are
         specified by the -m option.
.sp 2
         \fBNote: \fRWhen you use the -m option to specify
         multiple hosts for advance reservation, some hosts might
         not be selected for advance reservation (for example,
         because the hosts are exclusive and in \fRclosed\fR
         status). If at least one host in the list was
         successfully selected for advance reservation, the
         brsrvadd command indicates that the advance reservation
         was successfully created.
.sp 2
\fB-N \fIreservation_name\fB\fR
.br
         Specifies a user-defined advance reservation name unique
         in an LSF cluster. The name is a string of letters,
         numeric characters, underscores, and dashes. The name
         must begin with a letter. The maximum length of the name
         is 40 characters.
.sp 2
         If no user-defined advance reservation name is
         specified, LSF creates the reservation with a system
         assigned name in the following form:
.sp 2
         user_name#sequence
.br

.sp 2
         In the following example, the brsvadd command has no -N
         option, so the reservation is created with the system
         assigned name \fR Reservation user2#0\fR:
.sp 2
         brsvadd -n 3 -m "hostA hostB" -u user2 -b 16:0 -e 17:0 -d "Production AR test"
.br
         Reservation user2#0 (Production AR test) is created
.br
         
.br

.sp 2
         In the following example, the brsvadd command specifies
         the name \fRProduction_AR\fR on the -N option, so the
         reservation is created with the specified name:
.sp 2
         brsvadd -n 2 -N Production_AR -m hostA -u user2 -b 16:0 -e 17:0 -d "Production AR test"
.br
         Reservation Production_AR (Production AR test) is created
.br

.sp 2
         If a job already references a reservation with the
         specified name, an error message is returned: \fRThe
         specified reservation name is referenced by a job\fR.
.sp 2
\fB-n \fIjob_slots\fB or \fInumber_hosts\fB\fR
.br
         The number of either job slots or hosts (specified by
         the -unit option) to reserve. For a slot-based advance
         reservation (\fRbrsvadd -unit slot\fR), the -n option
         specifies the total number of job slots to reserve. For
         host-based advance reservation (\fRbrsvadd -unit
         host\fR), the -n option specifies the total number of
         hosts to reserve.
.sp 2
         The \fIjob_slots\fR or \fInumber_hosts\fR value must be
         less than or equal to the actual number of slots or
         hosts that are selected by the -m or -R option.
.sp 2
         If you also specify the reservation for system use with
         the -s option, the -n is not required.
.sp 2
\fB-q "\fIqueue_name\fB ..."\fR
.br
         Specifies the queues whose jobs are allowed to run on
         the advance reservation hosts even if the jobs\(aq run
         limits are greater than the amount of time until the
         advance reservation starts.
.sp 2
\fB-R "\fIres_req\fB"\fR
.br
         Selects hosts for the reservation according to the
         specified resource requirements. Only hosts that satisfy
         the resource requirement expression are reserved. The -R
         option accepts any valid resource requirement string,
         but only the \fRselect\fR and \fRsame\fR strings take
         effect.
.sp 2
         If you also specify a host list with the -m option, the
         -R is not required.
.sp 2
         For more information about specifying resource
         requirement strings, see Administering IBM Spectrum LSF.
.sp 2
\fB-t \fItime_window\fB\fR
.br
         Time window for a recurring reservation.
.sp 2
         To specify a time window, specify two time values that
         are separated by a hyphen (\fR-\fR), with no space in
         between:
.sp 2
         time_window = begin_time-end_time
.br

.sp 2
         Times are specified in the following format:
.sp 2
         [day:]hour[:minute]
.br

.sp 2
         All fields are numbers with the following ranges:
.sp 2
         \fB\fIday of the week\fB\fR
.br
                  0-6 (0 is Sunday).
.sp 2
         \fB\fIhour\fB\fR
.br
                  0-23
.sp 2
         \fB\fIminute\fB\fR
.br
                  0-59
.sp 2
         Specify a time window one of the following ways:
.sp 2
         *  \fR\fIhour\fR-\fIhour\fR\fR
.sp 2
         *  \fR\fIhour\fR:\fIminute\fR-\fIhour\fR:\fIminute\fR\fR
.sp 2
         *  \fR\fIday\fR:\fIhour\fR:\fIminute\fR-\fIday\fR:\fIhour\fR:\fIminute\fR\fR
.sp 2
         The default value for minute is 0 (on the hour). The
         default value for day is every day of the week.
.sp 2
         You must specify at least the hour. Day of the week and
         minute are optional. Both the start time and end time
         values must use the same syntax. If you do not specify a
         minute, LSF assumes the first minute of the hour
         (\fR:00\fR). If you do not specify a day, LSF assumes
         every day of the week. If you do specify the day, you
         must also specify the minute.
.sp 2
         To prevent running jobs from being killed when the
         reservation expires, LSF administrators can use the bmod
         -t option to change the termination time of the job
         before the reservation window closes.
.sp 2
         When the job starts running, the run limit of the
         reservation is set to the minimum of the job run limit
         (if specified), the queue run limit (if specified), or
         the duration of the time window.
.sp 2
\fB-u "\fIuser_name\fB ..." | \fI"user_group\fB ..."\fR
.br
         A list of users and user groups that have permission to
         use advance reservation.
.sp 2
         The \fR-u "\fIuser_name\fR ... | \fIuser_group\fR
         ..."\fR option does not support the \fR@cluster\fR
         notation for advance reservations on remote clusters.
.sp 2
\fB-unit [slot | host]\fR
.br
         Specifies whether an advance reservation is for a number
         of slots or hosts. If the -unit option is not specified,
         the advance reservation request uses the slot unit by
         default.
.sp 2
         The following options are required when used with the
         brsvadd command, regardless of whether you use the slot
         or host unit:
.sp 2
         *  The number of slots or hosts to reserve, with the -n
            option.
.sp 2
         *  The list of candidate hosts, with the -m option, the
            -R option, or both.
.sp 2
         *  Users or user groups that have permission to use the
            advance reservation, with the -u option.
.sp 2
         *  A time period for the reservation, with either the -t
            or the -b option and the -e option together.
.sp 2
\fB-h\fR
.br
         Prints command usage and exits.
.sp 2
\fB-V\fR
.br
         Prints LSF release version and exits.
.SH Examples

.sp 2
The following command creates a one-time advance reservation for
14 job slots on hosts \fRhostA\fR and \fRhostB\fR for \fRuser1\fR
and \fRgroup1\fR between 6:00 AM and 8:00 AM today:
.sp 2
brsvadd -unit slot -n 14 -m "hostA hostB" -u "user1 group1" -b 6:0 -e 8:0
.br
Reservation "user1#0" is created
.br

.sp 2
The following command creates an advance reservation for four
hosts and the reserved hosts have at least 16 slots:
.sp 2
brsvadd -unit host -n 4 -R "maxslots>=16"" -u "groupA groupB groupC" -b 3:0 -e 4:0
.br

.sp 2
Reservation "groupA#0" is created
.br

.sp 2
The following command creates an open advance reservation for
1024 job slots on host \fRhostA\fR for user \fRuser1\fR between
6:00 AM and 8:00 AM today.
.sp 2
brsvadd -o -n 1024 -m hostA -u user1 -b 6:0 -e 8:0
.br
Reservation "user1#0" is created
.SH See also

.sp 2
brsvdel, brsvmod, brsvs, lsb.resources